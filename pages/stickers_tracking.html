<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØªØ¨Ø¹ ØªØ³Ù„ÙŠÙ… ÙˆØªÙØ¹ÙŠÙ„ Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #ecf0f1;
        }

        .tab {
            padding: 15px 30px;
            background: none;
            border: none;
            color: #7f8c8d;
            font-size: 1.1em;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: bold;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 15px;
            color: white;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        .form-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: bold;
        }

        input[type="text"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            font-size: 1em;
            border: 2px solid #ddd;
            border-radius: 8px;
            transition: border-color 0.3s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            padding: 12px 25px;
            font-size: 1.1em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s;
            margin-right: 10px;
        }

        button:hover {
            transform: scale(1.05);
        }

        button.secondary {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
        }

        button.danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        button.success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: right;
            font-weight: bold;
        }

        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ecf0f1;
            text-align: right;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .badge-pending {
            background: #f39c12;
            color: white;
        }

        .badge-activated {
            background: #2ecc71;
            color: white;
        }

        .badge-reported {
            background: #e74c3c;
            color: white;
        }

        .badge-resolved {
            background: #3498db;
            color: white;
        }

        .action-buttons {
            display: flex;
            gap: 5px;
        }

        .action-btn {
            padding: 6px 12px;
            font-size: 0.9em;
            border-radius: 5px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }

        .empty-state-icon {
            font-size: 4em;
            margin-bottom: 20px;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: none;
        }

        .alert.show {
            display: block;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“‹ ØªØªØ¨Ø¹ ØªØ³Ù„ÙŠÙ… ÙˆØªÙØ¹ÙŠÙ„ Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</h1>
        <p class="subtitle">Ù†Ø¸Ø§Ù… Ù…ØªÙƒØ§Ù…Ù„ Ù„ØªØªØ¨Ø¹ ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù…Ù„ØµÙ‚Ø§ØªØŒ Ø§Ù„ØªÙØ¹ÙŠÙ„ØŒ ÙˆÙ…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>

        <div id="alert-container"></div>

        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-label">Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ù…ÙØ¹Ù„Ø©</div>
                <div class="stat-value" id="activated-count">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„ØªÙØ¹ÙŠÙ„</div>
                <div class="stat-value" id="pending-count">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</div>
                <div class="stat-value" id="misuse-count">0</div>
            </div>
            <div class="stat-card">
                <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªÙØ¹ÙŠÙ„</div>
                <div class="stat-value" id="activation-rate">0%</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('delivery')">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ³Ù„ÙŠÙ…</button>
            <button class="tab" onclick="switchTab('pending')">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</button>
            <button class="tab" onclick="switchTab('misuse')">ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ©</button>
            <button class="tab" onclick="switchTab('misuse-list')">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª</button>
        </div>

        <!-- ØªØ³Ø¬ÙŠÙ„ ØªØ³Ù„ÙŠÙ… Ù…Ù„ØµÙ‚ -->
        <div id="delivery-tab" class="tab-content active">
            <div class="form-section">
                <h2>ØªØ³Ø¬ÙŠÙ„ ØªØ³Ù„ÙŠÙ… Ù…Ù„ØµÙ‚ Ø¬Ø¯ÙŠØ¯</h2>
                <form id="delivery-form">
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© / Ø±Ù‚Ù… Ø§Ù„Ù…Ù„ØµÙ‚ *</label>
                        <input type="text" id="delivery-sticker-number" required>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ† *</label>
                        <input type="text" id="delivery-resident-name" required>
                    </div>
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ù„ÙˆØ­Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø© *</label>
                        <input type="text" id="delivery-plate-number" required>
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</label>
                        <input type="date" id="delivery-date" value="">
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ø¨Ù†Ù‰</label>
                        <input type="text" id="delivery-building">
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ø´Ù‚Ø©</label>
                        <input type="text" id="delivery-apartment">
                    </div>
                    <div class="form-group">
                        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="delivery-notes" rows="3"></textarea>
                    </div>
                    <button type="submit" class="success">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ³Ù„ÙŠÙ…</button>
                    <button type="reset" class="secondary">Ù…Ø³Ø­</button>
                </form>
            </div>
        </div>

        <!-- Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„ØªÙØ¹ÙŠÙ„ -->
        <div id="pending-tab" class="tab-content">
            <h2 style="margin-bottom: 20px;">Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ù…Ø³Ù„Ù…Ø© Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„ØªÙØ¹ÙŠÙ„</h2>
            <div id="pending-list"></div>
        </div>

        <!-- ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… -->
        <div id="misuse-tab" class="tab-content">
            <div class="form-section">
                <h2>ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ© Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„ØµÙ‚</h2>
                <form id="misuse-form">
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ù…Ù„ØµÙ‚ / Ø±Ù‚Ù… Ø§Ù„Ù‡ÙˆÙŠØ© *</label>
                        <input type="text" id="misuse-sticker-number" required>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ø§Ù„Ùƒ Ø§Ù„Ø£ØµÙ„ÙŠ *</label>
                        <input type="text" id="misuse-owner" required>
                    </div>
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¬Ù„Ø© *</label>
                        <input type="text" id="misuse-registered-plate" required>
                    </div>
                    <div class="form-group">
                        <label>Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ© (Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©) *</label>
                        <input type="text" id="misuse-actual-plate" required>
                    </div>
                    <div class="form-group">
                        <label>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© *</label>
                        <select id="misuse-type" required>
                            <option value="Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø£Ù‚Ø§Ø±Ø¨">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø£Ù‚Ø§Ø±Ø¨</option>
                            <option value="Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„ØºÙŠØ±">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù† Ù‚Ø¨Ù„ Ø§Ù„ØºÙŠØ±</option>
                            <option value="Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ØµÙ‚ Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ø®Ø±Ù‰">Ù†Ù‚Ù„ Ø§Ù„Ù…Ù„ØµÙ‚ Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ø®Ø±Ù‰</option>
                            <option value="Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„ØµÙ‚ Ù…Ù„ØºÙŠ">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ù„ØµÙ‚ Ù…Ù„ØºÙŠ</option>
                            <option value="Ø£Ø®Ø±Ù‰">Ø£Ø®Ø±Ù‰</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙØ¹Ù„ÙŠ</label>
                        <input type="text" id="misuse-actual-user">
                    </div>
                    <div class="form-group">
                        <label>ØµÙ„Ø© Ø§Ù„Ù‚Ø±Ø§Ø¨Ø©</label>
                        <input type="text" id="misuse-relation" placeholder="Ù…Ø«Ø§Ù„: Ø£Ø®ØŒ Ø§Ø¨Ù†ØŒ ØµØ¯ÙŠÙ‚">
                    </div>
                    <div class="form-group">
                        <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</label>
                        <input type="date" id="misuse-detected-date" value="">
                    </div>
                    <div class="form-group">
                        <label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label>
                        <textarea id="misuse-notes" rows="3"></textarea>
                    </div>
                    <button type="submit" class="danger">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©</button>
                    <button type="reset" class="secondary">Ù…Ø³Ø­</button>
                </form>
            </div>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª -->
        <div id="misuse-list-tab" class="tab-content">
            <h2 style="margin-bottom: 20px;">Ù‚Ø§Ø¦Ù…Ø© Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª</h2>
            <div id="misuse-list-container"></div>
        </div>
    </div>

    <script src="../js/stickers_integration.js"></script>
    <script>
        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ
        document.getElementById('delivery-date').value = new Date().toISOString().split('T')[0];
        document.getElementById('misuse-detected-date').value = new Date().toISOString().split('T')[0];

        // Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
            if (tabName === 'pending') {
                loadPendingList();
            } else if (tabName === 'misuse-list') {
                loadMisuseList();
            }
        }

        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø©
        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alert-container');
            alertContainer.innerHTML = `
                <div class="alert alert-${type} show">
                    ${message}
                </div>
            `;
            
            setTimeout(() => {
                alertContainer.innerHTML = '';
            }, 5000);
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        async function updateStats() {
            await window.stickersIntegration.initialize();
            const stats = window.stickersIntegration.getStatistics();
            
            document.getElementById('activated-count').textContent = stats.deliveryTracking.activatedStickers;
            document.getElementById('pending-count').textContent = stats.deliveryTracking.deliveredNotActivated;
            document.getElementById('misuse-count').textContent = stats.misuseTracking.totalMisuses;
            document.getElementById('activation-rate').textContent = stats.deliveryTracking.activationRate + '%';
        }

        // ØªØ³Ø¬ÙŠÙ„ ØªØ³Ù„ÙŠÙ… Ù…Ù„ØµÙ‚
        document.getElementById('delivery-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const deliveryData = {
                stickerNumber: document.getElementById('delivery-sticker-number').value,
                residentName: document.getElementById('delivery-resident-name').value,
                plateNumber: document.getElementById('delivery-plate-number').value,
                deliveryDate: document.getElementById('delivery-date').value,
                building: document.getElementById('delivery-building').value,
                apartment: document.getElementById('delivery-apartment').value,
                notes: document.getElementById('delivery-notes').value
            };
            
            const result = window.stickersIntegration.registerStickerDelivery(deliveryData);
            
            if (result.success) {
                showAlert('âœ“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ ØªØ³Ù„ÙŠÙ… Ø§Ù„Ù…Ù„ØµÙ‚ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                this.reset();
                document.getElementById('delivery-date').value = new Date().toISOString().split('T')[0];
                updateStats();
            } else {
                showAlert('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØªØ³Ù„ÙŠÙ…', 'error');
            }
        });

        // ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ©
        document.getElementById('misuse-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const misuseData = {
                stickerNumber: document.getElementById('misuse-sticker-number').value,
                originalOwner: document.getElementById('misuse-owner').value,
                registeredPlate: document.getElementById('misuse-registered-plate').value,
                actualPlate: document.getElementById('misuse-actual-plate').value,
                misuseType: document.getElementById('misuse-type').value,
                actualUser: document.getElementById('misuse-actual-user').value,
                relationToOwner: document.getElementById('misuse-relation').value,
                detectedDate: document.getElementById('misuse-detected-date').value,
                notes: document.getElementById('misuse-notes').value
            };
            
            const result = window.stickersIntegration.registerStickerMisuse(misuseData);
            
            if (result.success) {
                showAlert('âœ“ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ù…Ø®Ø§Ù„ÙØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­', 'success');
                this.reset();
                document.getElementById('misuse-detected-date').value = new Date().toISOString().split('T')[0];
                updateStats();
            } else {
                showAlert('âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©', 'error');
            }
        });

        // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
        function loadPendingList() {
            const pending = window.stickersIntegration.getUnactivatedStickers();
            const container = document.getElementById('pending-list');
            
            if (pending.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“­</div>
                        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„ØµÙ‚Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h3>
                        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª Ø§Ù„Ù…Ø³Ù„Ù…Ø© ØªÙ… ØªÙØ¹ÙŠÙ„Ù‡Ø§</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</th>
                            <th>Ø§Ù„Ù…Ø¨Ù†Ù‰/Ø§Ù„Ø´Ù‚Ø©</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù„ÙˆØ­Ø©</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ø³Ø§ÙƒÙ†</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ù„ØµÙ‚</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            pending.forEach(delivery => {
                html += `
                    <tr>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn success" onclick="activateSticker('${delivery.stickerNumber}')">
                                    ØªÙØ¹ÙŠÙ„
                                </button>
                            </div>
                        </td>
                        <td><span class="badge badge-pending">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span></td>
                        <td>${delivery.deliveryDate}</td>
                        <td>${delivery.building}/${delivery.apartment}</td>
                        <td>${delivery.plateNumber}</td>
                        <td>${delivery.residentName}</td>
                        <td>${delivery.stickerNumber}</td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
        }

        // ØªÙØ¹ÙŠÙ„ Ù…Ù„ØµÙ‚
        function activateSticker(stickerNumber) {
            const result = window.stickersIntegration.activateDeliveredSticker(stickerNumber);
            
            if (result.success) {
                showAlert('âœ“ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…Ù„ØµÙ‚ Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadPendingList();
                updateStats();
            } else {
                showAlert('âš ï¸ ' + result.error, 'error');
            }
        }

        // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª
        function loadMisuseList() {
            const misuses = window.stickersIntegration.getAllStickerMisuses();
            const container = document.getElementById('misuse-list-container');
            
            if (misuses.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">âœ…</div>
                        <h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø®Ø§Ù„ÙØ§Øª Ù…Ø³Ø¬Ù„Ø©</h3>
                        <p>Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø£ÙŠ Ù…Ø®Ø§Ù„ÙØ§Øª Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù„ØµÙ‚Ø§Øª</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ÙƒØªØ´Ø§Ù</th>
                            <th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ©</th>
                            <th>Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„ÙØ¹Ù„ÙŠØ©</th>
                            <th>Ø§Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø¬Ù„Ø©</th>
                            <th>Ø§Ù„Ù…Ø§Ù„Ùƒ</th>
                            <th>Ø±Ù‚Ù… Ø§Ù„Ù…Ù„ØµÙ‚</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            misuses.forEach(misuse => {
                const statusBadge = misuse.status === 'resolved' ? 'badge-resolved' : 
                                  misuse.status === 'confirmed' ? 'badge-reported' : 'badge-pending';
                const statusText = misuse.status === 'resolved' ? 'ØªÙ… Ø§Ù„Ø­Ù„' : 
                                 misuse.status === 'confirmed' ? 'Ù…Ø¤ÙƒØ¯Ø©' : 'Ù…Ø¨Ù„Øº Ø¹Ù†Ù‡Ø§';
                
                html += `
                    <tr>
                        <td>
                            <div class="action-buttons">
                                ${misuse.status !== 'resolved' ? `
                                    <button class="action-btn success" onclick="resolveMisuse(${misuse.id})">
                                        Ø­Ù„
                                    </button>
                                ` : ''}
                            </div>
                        </td>
                        <td><span class="badge ${statusBadge}">${statusText}</span></td>
                        <td>${misuse.detectedDate}</td>
                        <td>${misuse.misuseType}</td>
                        <td>${misuse.actualPlate}</td>
                        <td>${misuse.registeredPlate}</td>
                        <td>${misuse.originalOwner}</td>
                        <td>${misuse.stickerNumber}</td>
                    </tr>
                `;
            });
            
            html += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = html;
        }

        // Ø­Ù„ Ù…Ø®Ø§Ù„ÙØ©
        function resolveMisuse(misuseId) {
            const resolution = prompt('Ø£Ø¯Ø®Ù„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø­Ù„:');
            if (!resolution) return;
            
            const result = window.stickersIntegration.resolveStickerMisuse(misuseId, resolution);
            
            if (result.success) {
                showAlert('âœ“ ØªÙ… Ø­Ù„ Ø§Ù„Ù…Ø®Ø§Ù„ÙØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                loadMisuseList();
                updateStats();
            } else {
                showAlert('âš ï¸ ' + result.error, 'error');
            }
        }

        // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', async () => {
            await updateStats();
        });
    </script>
</body>
</html>
