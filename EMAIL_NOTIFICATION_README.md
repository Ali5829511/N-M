# ูุธุงู ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
# Email Notification System

## ๐ง ูุธุฑุฉ ุนุงูุฉ | Overview

ุชู ุฅุถุงูุฉ ูุธุงู ูุชูุงูู ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฅูู ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑูุฑ. ูุณุชุฎุฏู ุงููุธุงู ุฎุฏูุฉ EmailJS ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ุชููุงุฆูุงู ุนูุฏ ุญุฏูุซ ุฃุญุฏุงุซ ูููุฉ.

An integrated email notification system has been added to the Traffic Management System. The system uses EmailJS service to automatically send notifications when important events occur.

## โจ ุงูููุฒุงุช | Features

### ุงูุฅุดุนุงุฑุงุช ุงููุฏุนููุฉ | Supported Notifications
- โ ุฅุดุนุงุฑ ุนูุฏ ุฅูุดุงุก ูุณุชุฎุฏู ุฌุฏูุฏ | New user creation notification
- โ ุฅุดุนุงุฑ ุนูุฏ ุชุณุฌูู ูุฎุงููุฉ ุฌุฏูุฏุฉ | New violation registration notification
- โ ุฅุดุนุงุฑุงุช ุงููุธุงู ุงูุนุงูุฉ | General system notifications
- ๐ ุฅุดุนุงุฑ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ | Password reset notification (future)

### ุงูุชุญูู ูุงูุฅุนุฏุงุฏุงุช | Control & Settings
- โ ุชูุนูู/ุชุนุทูู ุงูุฎุฏูุฉ | Enable/disable service
- โ ุชูููู ุจูุงูุงุช EmailJS | Configure EmailJS credentials
- โ ุงูุชุญูู ูู ุฃููุงุน ุงูุฅุดุนุงุฑุงุช | Control notification types
- โ ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุงูุจุฑูุฏ | Test email sending
- โ ูุงุฌูุฉ ุฅุฏุงุฑุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู | User-friendly admin interface

## ๐ ููููุฉ ุงูุฅุนุฏุงุฏ | Setup Instructions

### ุงูุฎุทูุฉ 1: ุฅูุดุงุก ุญุณุงุจ EmailJS
1. ุงุฐูุจ ุฅูู [EmailJS](https://www.emailjs.com)
2. ุฃูุดุฆ ุญุณุงุจุงู ูุฌุงููุงู
3. ูู ุจุชุณุฌูู ุงูุฏุฎูู

### ุงูุฎุทูุฉ 2: ุฅุถุงูุฉ ุฎุฏูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
1. ูู ููุญุฉ ุงูุชุญููุ ุงุฐูุจ ุฅูู **Email Services**
2. ุงุถุบุท ุนูู **Add New Service**
3. ุงุฎุชุฑ ูุฒูุฏ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (Gmail, Outlook, ุฅูุฎ)
4. ุงุชุจุน ุงูุชุนูููุงุช ูุฑุจุท ุญุณุงุจู
5. ุงุญูุธ **Service ID** (ูุซุงู: `service_abc123`)

### ุงูุฎุทูุฉ 3: ุฅูุดุงุก ููุงูุจ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
ุฃูุดุฆ ุงูููุงูุจ ุงูุชุงููุฉ ูู EmailJS:

#### 1. ูุงูุจ ุงููุณุชุฎุฏู ุงูุฌุฏูุฏ (user_created)
**Template ID:** `template_user_created`

**ุงููุชุบูุฑุงุช ุงููุทููุจุฉ:**
- `to_email`: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุณุชุฎุฏู
- `to_name`: ุงุณู ุงููุณุชุฎุฏู
- `username`: ุงุณู ุงููุณุชุฎุฏู ููุฏุฎูู
- `role`: ุฏูุฑ ุงููุณุชุฎุฏู
- `login_url`: ุฑุงุจุท ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

**ูุซุงู ุนูู ุงููุงูุจ:**
```
ูุฑุญุจุงู {{to_name}}ุ

ุชู ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ ูู ูู ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑูุฑ.

ูุนูููุงุช ุงูุญุณุงุจ:
- ุงุณู ุงููุณุชุฎุฏู: {{username}}
- ุงูุฏูุฑ: {{role}}

ููููู ุชุณุฌูู ุงูุฏุฎูู ูู ุฎูุงู ุงูุฑุงุจุท ุงูุชุงูู:
{{login_url}}

ูุน ุชุญูุงุชูุงุ
ูุฑูู ูุธุงู ุฅุฏุงุฑุฉ ุงููุฑูุฑ
```

#### 2. ูุงูุจ ุงููุฎุงููุฉ ุงูุฌุฏูุฏุฉ (violation_added)
**Template ID:** `template_violation_added`

**ุงููุชุบูุฑุงุช ุงููุทููุจุฉ:**
- `to_email`: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุฅุฏุงุฑุฉ
- `violation_id`: ุฑูู ุงููุฎุงููุฉ
- `plate_number`: ุฑูู ุงูููุญุฉ
- `violation_type`: ููุน ุงููุฎุงููุฉ
- `violation_date`: ุชุงุฑูุฎ ุงููุฎุงููุฉ
- `location`: ูููุน ุงููุฎุงููุฉ
- `view_url`: ุฑุงุจุท ุนุฑุถ ุงููุฎุงููุฉ

**ูุซุงู ุนูู ุงููุงูุจ:**
```
ุชูุจูู: ุชู ุชุณุฌูู ูุฎุงููุฉ ุฌุฏูุฏุฉ

ุชูุงุตูู ุงููุฎุงููุฉ:
- ุฑูู ุงููุฎุงููุฉ: {{violation_id}}
- ุฑูู ุงูููุญุฉ: {{plate_number}}
- ููุน ุงููุฎุงููุฉ: {{violation_type}}
- ุงูุชุงุฑูุฎ: {{violation_date}}
- ุงููููุน: {{location}}

ูุนุฑุถ ุงูุชูุงุตูู ุงููุงููุฉ:
{{view_url}}
```

#### 3. ูุงูุจ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ (password_reset)
**Template ID:** `template_password_reset`

**ุงููุชุบูุฑุงุช ุงููุทููุจุฉ:**
- `to_email`: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ูููุณุชุฎุฏู
- `username`: ุงุณู ุงููุณุชุฎุฏู
- `reset_link`: ุฑุงุจุท ุฅุนุงุฏุฉ ุงูุชุนููู
- `expiry_time`: ูุฏุฉ ุตูุงุญูุฉ ุงูุฑุงุจุท

#### 4. ูุงูุจ ุงูุฅุดุนุงุฑุงุช ุงูุนุงูุฉ (system_notification)
**Template ID:** `template_system_notification`

**ุงููุชุบูุฑุงุช ุงููุทููุจุฉ:**
- `to_email`: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- `subject`: ููุถูุน ุงูุฑุณุงูุฉ
- `message`: ูุญุชูู ุงูุฑุณุงูุฉ
- `system_name`: ุงุณู ุงููุธุงู

### ุงูุฎุทูุฉ 4: ุงูุญุตูู ุนูู ุงูููุชุงุญ ุงูุนุงู
1. ูู ููุญุฉ ุงูุชุญููุ ุงุฐูุจ ุฅูู **Account**
2. ุงูุณุฎ **Public Key** (ูุซุงู: `user_xyz789`)

### ุงูุฎุทูุฉ 5: ุชูููู ุงููุธุงู
1. ุณุฌู ุงูุฏุฎูู ููุฏูุฑ (admin)
2. ุงุฐูุจ ุฅูู **ููุญุฉ ุงูุชุญูู ุงูููุญุฏุฉ**
3. ุงุถุบุท ุนูู **ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
4. ุฃุฏุฎู ุงููุนูููุงุช ุงูุชุงููุฉ:
   - ูุนุฑู ุงูุฎุฏูุฉ (Service ID)
   - ุงูููุชุงุญ ุงูุนุงู (Public Key)
   - ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุฅุฏุงุฑุฉ
5. ูุนูู ุงูุฎูุงุฑุงุช ุงููุทููุจุฉ
6. ุงุถุบุท **ุญูุธ ุงูุฅุนุฏุงุฏุงุช**
7. ุงุฎุชุจุฑ ุงูุฅุนุฏุงุฏุงุช ุจุฅุฑุณุงู ุจุฑูุฏ ุชุฌุฑูุจู

## ๐ ุงููููุงุช ุงููุถุงูุฉ | Added Files

```
โโโ js/
โ   โโโ email-service.js         # ุฎุฏูุฉ ุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
โโโ email_settings.html          # ุตูุญุฉ ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
โโโ EMAIL_NOTIFICATION_README.md # ูุฐุง ุงูููู
```

## ๐ง ุงููููุงุช ุงููุนุฏูุฉ | Modified Files

- `unified_dashboard.html` - ุฅุถุงูุฉ ุฑุงุจุท ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
- `advanced_users_management.html` - ุฅุถุงูุฉ ุฅุดุนุงุฑ ุนูุฏ ุฅูุดุงุก ูุณุชุฎุฏู
- `ุงููุฎุงููุงุช_ุงููุฑูุฑูุฉ.html` - ุฅุถุงูุฉ ุฅุดุนุงุฑ ุนูุฏ ุชุณุฌูู ูุฎุงููุฉ

## ๐ฏ ุงูุงุณุชุฎุฏุงู | Usage

### ุชูุนูู ุงูุฎุฏูุฉ
1. ุงุฐูุจ ุฅูู **ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
2. ูุนูู ุงูุฎูุงุฑ "ุชูุนูู ุฎุฏูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"
3. ุชุฃูุฏ ูู ุฅุฏุฎุงู ุฌููุน ุงููุนูููุงุช ุงููุทููุจุฉ
4. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช

### ุฅููุงู ุงูุฎุฏูุฉ
1. ุงุฐูุจ ุฅูู **ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
2. ุนุทูู ุงูุฎูุงุฑ "ุชูุนูู ุฎุฏูุฉ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู"
3. ุงุญูุธ ุงูุฅุนุฏุงุฏุงุช

### ุงุฎุชุจุงุฑ ุงูุฅุนุฏุงุฏุงุช
1. ุงุฐูุจ ุฅูู **ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
2. ูู ูุณู "ุงุฎุชุจุงุฑ ุงูุฅุนุฏุงุฏุงุช"
3. ุฃุฏุฎู ุจุฑูุฏู ุงูุฅููุชุฑููู
4. ุงุถุบุท "ุฅุฑุณุงู ุจุฑูุฏ ุชุฌุฑูุจู"
5. ุชุญูู ูู ุตูุฏูู ุงููุงุฑุฏ

## ๐ API Reference

### EmailService Class

#### Methods

```javascript
// ุชููุฆุฉ ุงูุฎุฏูุฉ
emailService.init()

// ุชุญููู ุงูุฅุนุฏุงุฏุงุช
emailService.loadEmailSettings()

// ุญูุธ ุงูุฅุนุฏุงุฏุงุช
emailService.saveEmailSettings(settings)

// ุงูุชุญูู ูู ุชูุนูู ุงูุฎุฏูุฉ
emailService.isEmailEnabled()

// ุฅุฑุณุงู ุจุฑูุฏ ุฅููุชุฑููู
await emailService.sendEmail(templateId, params)

// ุฅุฑุณุงู ุฅุดุนุงุฑ ูุณุชุฎุฏู ุฌุฏูุฏ
await emailService.notifyUserCreated(userData)

// ุฅุฑุณุงู ุฅุดุนุงุฑ ูุฎุงููุฉ ุฌุฏูุฏุฉ
await emailService.notifyViolationAdded(violationData)

// ุฅุฑุณุงู ุฅุดุนุงุฑ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
await emailService.notifyPasswordReset(email, username, resetToken)

// ุฅุฑุณุงู ุฅุดุนุงุฑ ุนุงู
await emailService.notifySystem(recipient, subject, message)

// ุงุฎุชุจุงุฑ ุงูุฅุนุฏุงุฏุงุช
await emailService.testEmailConfiguration(testEmail)

// ุงูุญุตูู ุนูู ุญุงูุฉ ุงูุฎุฏูุฉ
emailService.getStatus()
```

## ๐ ุงูุฃูุงู | Security

### ููุงุญุธุงุช ุฃูููุฉ ูููุฉ:
- โ **ุงูููุชุงุญ ุงูุนุงู (Public Key)** ูุตูู ููููู ุนุงูุงู ุญุณุจ ูููุฐุฌ ุฃูุงู EmailJS - ูุง ูุญุชูู ุนูู ูุนูููุงุช ุญุณุงุณุฉ
- โ๏ธ ุงูููุชุงุญ ุงูุนุงู ููุฎุฒู ูู `localStorage` - ูุฐุง ุทุจูุนู ูุชุทุจููุงุช EmailJS ูู ุฌุงูุจ ุงูุนููู
- โ๏ธ EmailJS ูุฏุนู 200 ุจุฑูุฏ ุดูุฑูุงู ูู ุงูุฎุทุฉ ุงููุฌุงููุฉ
- โ ุงุณุชุฎุฏู ุญุณุงุจ ุจุฑูุฏ ูุฎุตุต ููุชุทุจูู
- โ ูุง ุชุณุชุฎุฏู ุจุฑูุฏู ุงูุดุฎุตู
- โ๏ธ **ููู**: ูุง ูุชู ุชุฎุฒูู ูููุงุช ูุฑูุฑ ุฃู ููุงุชูุญ ุฎุงุตุฉ ูู ุงููุธุงู

### ุชูุตูุงุช ุงูุฅูุชุงุฌ:
1. ุงููู ูุนุงูุฌุฉ ุงูุจุฑูุฏ ุฅูู ุงูุฎุงุฏู (Server-side)
2. ุงุณุชุฎุฏู API ุฎููู ุขูู
3. ูู ุจุชุดููุฑ ุจูุงูุงุช ุงูุงุนุชูุงุฏ
4. ุฃุถู Rate Limiting
5. ุณุฌู ุฌููุน ุนูููุงุช ุฅุฑุณุงู ุงูุจุฑูุฏ

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก | Troubleshooting

### ุงููุดููุฉ: ูุง ูุชู ุฅุฑุณุงู ุงูุจุฑูุฏ
**ุงูุญููู:**
1. ุชุฃูุฏ ูู ุชูุนูู ุงูุฎุฏูุฉ ูู ุงูุฅุนุฏุงุฏุงุช
2. ุชุญูู ูู ุตุญุฉ Service ID ู Public Key
3. ุชุฃูุฏ ูู ุฅูุดุงุก ุงูููุงูุจ ุงููุทููุจุฉ ูู EmailJS
4. ุงูุชุญ Console ูู ุงููุชุตูุญ ููุชุญูู ูู ุงูุฃุฎุทุงุก
5. ุฌุฑูุจ ุฅุฑุณุงู ุจุฑูุฏ ุชุฌุฑูุจู

### ุงููุดููุฉ: ุฎุทุฃ "EmailJS library not loaded"
**ุงูุญู:** ุชุฃูุฏ ูู ุชุญููู ููุชุจุฉ EmailJS ูู ุงูุตูุญุฉ:
```html
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
```

### ุงููุดููุฉ: ุงูุจุฑูุฏ ูุตู ุฅูู ูุฌูุฏ Spam
**ุงูุญููู:**
1. ุงุณุชุฎุฏู ูุฒูุฏ ุจุฑูุฏ ููุซูู (Gmail, Outlook)
2. ุฃุถู ุงูุณุฌูุงุช ุงูููุงุณุจุฉ (SPF, DKIM) ูู ุฅุนุฏุงุฏุงุช ุงููุทุงู
3. ุชุฌูุจ ุงููููุงุช ุงูุชู ูุฏ ุชูุนุชุจุฑ Spam
4. ุงุณุชุฎุฏู ููุงูุจ ุงุญุชุฑุงููุฉ

## ๐ ุฃูุซูุฉ | Examples

### ูุซุงู 1: ุฅุฑุณุงู ุฅุดุนุงุฑ ูุฎุตุต
```javascript
await window.emailService.notifySystem(
    'user@example.com',
    'ุชูุจูู ููู',
    'ูุฐู ุฑุณุงูุฉ ุงุฎุชุจุงุฑ ูู ุงููุธุงู'
);
```

### ูุซุงู 2: ุงูุชุญูู ูู ุญุงูุฉ ุงูุฎุฏูุฉ
```javascript
const status = window.emailService.getStatus();
console.log('Email service enabled:', status.enabled);
console.log('Email service configured:', status.configured);
```

### ูุซุงู 3: ุฅุฑุณุงู ุฅุดุนุงุฑ ุนูุฏ ุญุฏุซ ูุนูู
```javascript
document.getElementById('myButton').addEventListener('click', async () => {
    if (window.emailService.isEmailEnabled()) {
        await window.emailService.notifySystem(
            'admin@university.edu.sa',
            'ุชู ุงูุถุบุท ุนูู ุงูุฒุฑ',
            'ูุงู ูุณุชุฎุฏู ุจุงูุถุบุท ุนูู ุงูุฒุฑ ูู ุงููุธุงู'
        );
    }
});
```

## ๐ฎ ุงูุชุทููุฑ ุงููุณุชูุจูู | Future Development

- [ ] ุฅุถุงูุฉ ููุฒุฉ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
- [ ] ุฅุถุงูุฉ ููุงูุจ ุจุฑูุฏ ุฅููุชุฑููู ูุชูุฏูุฉ ูุน HTML
- [ ] ุฏุนู ุงููุฑููุงุช
- [ ] ุฅุถุงูุฉ ุณุฌู ูุนูููุงุช ุฅุฑุณุงู ุงูุจุฑูุฏ
- [ ] ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุฏูุฑูุฉ (ูุซู ุงูุชูุงุฑูุฑ ุงูุฃุณุจูุนูุฉ)
- [ ] ุฏุนู ูุบุงุช ูุชุนุฏุฏุฉ ูู ุงูููุงูุจ
- [ ] ุชูุงูู ูุน ุฎุฏูุงุช ุจุฑูุฏ ุฃุฎุฑู (SendGrid, AWS SES)

## ๐ ุงูุฏุนู | Support

ูููุณุงุนุฏุฉ ูุงูุฏุนู:
- ุฑุงุฌุน ุงูุชูุซูู ุฃุนูุงู
- ุงูุชุญ Issue ูู GitHub
- ุฑุงุฌุน [ุชูุซูู EmailJS](https://www.emailjs.com/docs/)

## ๐ ุงูุชุฑุฎูุต | License

ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025 - ุฌุงูุนุฉ ุงูุฅูุงู ูุญูุฏ ุจู ุณุนูุฏ ุงูุฅุณูุงููุฉ

---

**ููุงุญุธุฉ:** ูุฐุง ุงููุธุงู ูุตูู ููุงุณุชุฎุฏุงู ุงูุชุนูููู ูุงูุชุทููุฑ. ูู ุจูุฆุฉ ุงูุฅูุชุงุฌุ ูููุตุญ ุจุงุณุชุฎุฏุงู ุญู ุฎุงุฏู (server-side) ุขูู ูุฅุฑุณุงู ุงูุจุฑูุฏ ุงูุฅููุชุฑููู.

**Note:** This system is designed for educational and development use. In production environment, it is recommended to use a secure server-side solution for sending emails.
